// EXPECT: PASS
// SOLVER_ARGS: --path ^entry,^init,^loop_cond,^loop_body,^rotate,^done,^exit

struct @RBNode {
    key: i32;
    color: i32;
    children: [2] i32;
}

struct @TreeConfig {
    nodes: [2] @RBNode;
    root: @RBNode;
    meta: [2] i32;
}

struct @ProblemAnswer {
    trees: [2] @TreeConfig;
    active_tree: @TreeConfig;
    op_counts: [4] i32;
}

fun @main(): i32 {
    let mut %ans: @ProblemAnswer = {
        {
            { {{10, 1, {1, 0}}, {20, 0, {0, 0}}}, {10, 1, {1, 0}}, {1, 2} },
            { {{30, 1, {0, 0}}, {40, 0, {0, 0}}}, {30, 1, {0, 0}}, {3, 4} }
        },
        { {{50, 1, {0, 0}}, {60, 0, {0, 0}}}, {50, 1, {0, 0}}, {5, 6} },
        {0, 0, 0, 0}
    };
    let mut %i: i32 = 0;
    let mut %k: i32 = 0;
    let %one: i32 = 1;
    let %limit: i32 = 2;

^entry:
    br ^init;

^init:
    %i = 0;
    br ^loop_cond;

^loop_cond:
    br %i < %limit, ^loop_body, ^exit;

^loop_body:
    %k = %ans.trees[%i].nodes[0].key;
    br %k > 0, ^rotate, ^done;

^rotate:
    %ans.op_counts[%i] = %ans.op_counts[%i] + %one;
    br ^done;

^done:
    %i = %i + %one;
    br ^loop_cond;

^exit:
    ret 0;
}
